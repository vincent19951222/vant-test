# 首页（对话页）差异分析与改进任务清单

## 1. 原型与实际效果对比分析

### 布局结构
- **底部输入栏**：
  - **原型**：悬浮式设计，背景透明渐变，输入框为自动增高 `textarea`。
  - **实现**：固定底部白色背景，单行 `input`，无法换行。
- **欢迎卡片**：
  - **原型**：包含头像、在线状态、快捷操作按钮并排布局。
  - **实现**：结构简化，样式细节（如圆角、阴影）未完全还原。
- **消息气泡**：
  - **原型**：Tailwind 高级阴影，Lucide 图标，精细的圆角处理。
  - **实现**：普通阴影，Vant 图标，圆角和边距略有差异。

### 交互逻辑
- **输入体验**：原型支持多行输入，实现仅支持单行。
- **加载状态**：原型有 "Typing" 三点跳动动画，实现完全缺失。
- **反馈交互**：原型中机器人回复下方的“复制”、“有用”按钮有 Hover 效果，实现中未绑定事件。

---

## 2. 差异分析与改进方案

| 差异位置 | 差异类型 | 严重程度 | 差异描述 | 推荐解决方案 | 预计工作量 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **底部输入框** | 交互/UI | **高** | 当前为单行 `input`，无法输入长文本；背景缺乏渐变过渡，生硬截断。 | 1. 替换为 `textarea` 组件，实现 `auto-height`。<br>2. 增加底部背景渐变蒙层优化视觉。 | 2 小时 |
| **思考中状态** | 功能/交互 | **高** | 缺少 AI 思考时的 "Typing" 动画，用户感知差。 | 新增 `typing` 类型的消息模版，使用 CSS 动画实现三点跳动效果。 | 1.5 小时 |
| **图标风格** | UI | 中 | Vant 图标与设计稿 Lucide 风格不符，显得粗糙。 | 引入 SVG 图标或寻找更接近 Lucide 风格的小程序图标库（或自定义 SVG 组件）。 | 2 小时 |
| **反馈功能** | 功能 | 中 | “复制”、“有用”按钮无响应。 | 绑定 `bindtap` 事件，实现 `wx.setClipboardData` 和点赞状态切换逻辑。 | 0.5 小时 |
| **欢迎卡片** | UI | 低 | 头部排版较简单，缺乏层级感。 | 优化 `isWelcome` 状态下的 DOM 结构，对齐原型的 Flex 布局和样式。 | 1 小时 |

---

## 3. 开发任务清单

### TASK-001: 优化底部输入栏交互与样式
*   **优先级**: P0 (High)
*   **关联差异**: 底部输入框
*   **解决方案**:
    1.  修改 `pages/index/index.wxml`，将 `<input>` 替换为 `<textarea>`。
    2.  设置 `textarea` 的 `auto-height` 属性，并限制最大高度（如 `max-height: 100px`）。
    3.  修改 `pages/index/index.wxss`，为底部区域添加 `backdrop-filter` 或渐变背景图片，模拟原型的悬浮透视感。
    4.  调整输入框容器的圆角和阴影，使其更接近 iOS 风格。
*   **验收标准**:
    *   输入框随内容自动增高，且不超过最大高度。
    *   底部区域背景过渡自然。
    *   输入长文本时体验流畅。

### TASK-002: 实现 AI 思考中 (Typing) 状态
*   **优先级**: P0 (High)
*   **关联差异**: 思考中状态
*   **解决方案**:
    1.  在 `pages/index/index.js` 的 `data` 中新增一种消息类型 `type: 'typing'`。
    2.  在发送消息后，立即向 `messages` 数组追加一个 `typing` 类型的消息。
    3.  在收到真实回复（模拟回调）前，移除该 `typing` 消息。
    4.  在 `pages/index/index.wxml` 中实现 `typing` 状态的视图，包含三个跳动的圆点动画（CSS keyframes）。
*   **验收标准**:
    *   发送消息后立即显示“对方正在输入”动画。
    *   收到回复后动画自然消失。
    *   动画效果流畅，圆点跳动节奏协调。

### TASK-003: 完善消息反馈交互逻辑
*   **优先级**: P1 (Medium)
*   **关联差异**: 反馈功能
*   **解决方案**:
    1.  在 `pages/index/index.wxml` 中为“复制”按钮绑定 `onCopy` 事件。
    2.  在 `pages/index/index.wxml` 中为“有用”按钮绑定 `onLike` 事件。
    3.  在 `pages/index/index.js` 中实现 `onCopy`，调用 `wx.setClipboardData`。
    4.  在 `pages/index/index.js` 中实现 `onLike`，切换按钮的图标状态（实心/空心）并弹出 Toast 提示。
*   **验收标准**:
    *   点击“复制”可成功复制内容到剪贴板。
    *   点击“有用”能看到明显的 UI 状态变化。

### TASK-004: UI 细节与图标优化
*   **优先级**: P1 (Medium)
*   **关联差异**: 图标风格 / 欢迎卡片
*   **解决方案**:
    1.  将 `van-icon` 替换为自定义的 `<image>` 或 `<view>` 组件加载 SVG，以匹配 Lucide 风格（细线条）。
    2.  优化欢迎卡片的 HTML 结构，使用 Flex 布局对齐头像和文本。
    3.  调整全局颜色变量，确保背景色 `#F5F7FA` 和字体颜色与设计稿一致。
*   **验收标准**:
    *   关键图标（发送、加号、机器人）清晰精致。
    *   欢迎卡片视觉层次分明。

### TASK-005: 语音输入功能预埋
*   **优先级**: P2 (Low)
*   **关联差异**: 语音输入
*   **解决方案**:
    1.  为麦克风图标绑定 `touchstart` 和 `touchend` 事件。
    2.  实现按住录音的 UI 反馈（如弹出录音波形图层）。
    3.  调用 `wx.getRecorderManager` 进行简单的录音测试（暂不接 API）。
*   **验收标准**:
    *   按住麦克风有视觉反馈。
    *   能够触发录音权限请求。
